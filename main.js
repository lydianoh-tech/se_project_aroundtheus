!function(){"use strict";class t{constructor(t,e){let{items:s,renderer:r}=t;this._items=s,this._renderer=r,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}class e{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popup.addEventListener("click",(t=>{(t.target.classList.contains("modal__close-icon")||t.target===this._popup)&&this.close()}))}}class s extends e{constructor(t,e){super(t),this._form=this._popup.querySelector(".modal__form"),this._inputList=this._form.querySelectorAll(".modal__input"),this._submitButton=this._popup.querySelector(".modal__submit-button"),this._submitBtnText=this._submitButton.textContent,this._handleFormSubmit=e}getForm(){return this._form}renderLoading(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=t?e:this._submitBtnText}_getInputValues(){const t={};return this._inputList.forEach((e=>{t[e.name]=e.value})),t}setInputValues(t){this._inputList.forEach((e=>{e.value=t[e.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}setButtonText(t){this._submitButton&&(this._submitButton.textContent=t)}getButtonText(){return this._submitButton?this._submitButton.textContent:""}}class r{constructor(t,e,s,r,i){this._data=t,this._likes=t.likes||[],this._ownerId=t.owner,this._userId=t.currentUserId,this._id=t._id||t.id,this._name=t.name,this._link=t.link,this._cardSelector=e,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i}_updateLikesView(){this.isLiked()?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.toggle("card__like-button_active",this.isLiked())}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}isLiked(){return this._data.isLiked}setLikesInfo(t){this._data=t,this._updateLikesView()}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this._id,this.isLiked())})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this._id,this._element)}))}generateCard(){return this._element=this._getTemplate(),this._cardImageElement=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._element.querySelector(".card__title").textContent=this._name,this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._updateLikesView(),this._setEventListeners(),this._element}updateCard(){this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._titleElement.textContent=this._name,this._likeCountElement.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}updateLikes(t){this._likes=t,this._updateCard()}}class i{constructor(t,e){this.settings=t,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._formElement=e,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_showError(t){const e=this._formElement.querySelector(`#${t.id}-error`);e&&(e.textContent=t.validationMessage,e.classList.add(this._errorClass)),t.classList.add(this._inputErrorClass)}_hideError(t){const e=this._formElement.querySelector(`#${t.id}-error`);e&&(e.textContent="",e.classList.remove(this._errorClass)),t.classList.remove(this._inputErrorClass)}_checkInputValidity(t){t.validity.valid?this._hideError(t):this._showError(t)}_toggleButtonState(){this._inputList.every((t=>t.validity.valid))?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):this.disableButton()}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((t=>this._hideError(t))),this._toggleButtonState()}}const n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_type_disabled",inputErrorClass:"popup__input_type_error",errorClass:"modal__error"};document.querySelector("#profile__edit-button"),document.querySelector("#profile__modal"),document.querySelector("#modal__profile-title"),document.querySelector("#profile__title"),document.querySelector("#profile__description"),document.querySelector("#profile__name-input"),document.querySelector("#profile__description-input"),document.querySelector("#profile__add-button"),document.querySelector("#cards__list"),document.querySelector("#cards__template").content.querySelector(".card");const o=document.forms.profile__form,a=document.forms.card__form,l=(document.querySelector("#add__card-modal"),document.querySelector("#add__card-title"),document.querySelector("#add__card-name"),document.querySelector("#add__card-link"),document.querySelector("#image__modal")),d=(l.querySelector("#image__link"),l.querySelector("#image__title"),new class{constructor(t){let{baseUrl:e,headers:s}=t;this._baseUrl=e,this._headers=s}_checkResponse(t){return t.ok?t.json():Promise.reject(`Error: ${t.status}`)}_request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={headers:this._headers,...e},r=`${this._baseUrl}${t}`;return fetch(r,s).then(this._checkResponse)}getUserInfo(){return this._request("/users/me")}updateProfile(t){let{name:e,about:s}=t;return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:s})})}updateAvatar(t){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:t})})}getInitialCards(){return this._request("/cards")}addCard(t){let{name:e,link:s}=t;return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:s})})}deleteCard(t){return this._request(`/cards/${t}`,{method:"DELETE"})}likeCard(t){return this._request(`/cards/${t}/likes`,{method:"PUT"})}unlikeCard(t){return this._request(`/cards/${t}/likes`,{method:"DELETE"})}getAppData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"1c65c6f1-abdd-470a-ae4d-370153ad05d9","Content-Type":"application/json"}})),_=new class{constructor(t){let{nameSelector:e,jobSelector:s,avatarSelector:r}=t;this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}getUserId(){return this._userId}setUserInfo(t){let{name:e,job:s,avatar:r,id:i}=t;this._nameElement.textContent=e,this._jobElement.textContent=s,this.setUserAvatar(r),this._userId=i}setUserAvatar(t){this._avatarElement.src=t}}({nameSelector:"#profile__title",jobSelector:"#profile__description",avatarSelector:".profile__image"});function c(t){const e={...t,currentUserId:_.getUserId()},s=new r(e,"#cards__template",((t,e)=>{u.open({name:t,link:e})}),v,((t,e)=>(e?d.unlikeCard(t):d.likeCard(t)).then((t=>{s.setLikesInfo(t)})).catch((t=>{console.error("Error liking card:",t)}))));return s.generateCard()}const u=new class extends e{constructor(t){super(t),this._image=this._popup.querySelector(".modal__image-link"),this._caption=this._popup.querySelector(".modal__image-title")}open(t){let{name:e,link:s}=t;this._image.src=s,this._image.alt=e,this._caption.textContent=e,super.open()}}("#image__modal");let h;u.setEventListeners(),Promise.all([d.getUserInfo(),d.getInitialCards()]).then((e=>{let[s,r]=e;_.setUserInfo({name:s.name,job:s.about,avatar:s.avatar,id:s._id}),h=new t({items:r,renderer:t=>{const e=c(t);h.addItem(e)}},"#cards__list"),h.renderItems()})).catch((t=>{console.error("Error loading app data:",t)}));const m=new class extends e{constructor(t,e){super(t),this._handleConfirm=e,this._confirmButton=this._popup.querySelector("#delete__card-confirm-button")}setEventListeners(){this._confirmButton.addEventListener("click",(t=>{t.preventDefault(),this._handleConfirm()})),super.setEventListeners()}setButtonText(t){this._confirmButton&&(this._confirmButton.textContent=t)}}("#delete__card-modal",(()=>{d.deleteCard(p).then((()=>{E.remove(),m.close()})).catch((t=>{console.error("Error deleting card:",t)})).finally((()=>{m.setButtonText("Yes")})),console.log(p)}));m.setEventListeners();let p=null,E=null;function v(t,e){p=t,E=e,m.open()}function f(t,e,s){t.renderLoading(!0),e.then((e=>{s(e),t.close()})).catch((t=>{console.error("Error:",t)})).finally((()=>{t.renderLoading(!1)}))}const b=new s("#profile__modal",(t=>{f(b,d.updateProfile({name:t.name,about:t.description}),(t=>{_.setUserInfo({name:t.name,job:t.about,avatar:t.avatar,id:t._id})}))}));b.setEventListeners();const S=new s("#add__card-modal",(t=>{f(S,d.addCard({name:t.title,link:t.image}),(t=>{const e=c(t);h.addItem(e),a.reset(),L.disableButton()}))}));S.setEventListeners();const k=new s("#update__avatar-modal",(t=>{f(k,d.updateAvatar(t.avatar),(t=>{_.setUserAvatar(t.avatar)}))}));k.setEventListeners(),document.querySelector("#profile__edit-button").addEventListener("click",(()=>{const t=_.getUserInfo();b.setInputValues({name:t.name,description:t.job}),b.open()})),document.querySelector("#profile__add-button").addEventListener("click",(()=>{S.open()})),document.querySelector("#profile__avatar-edit-button").addEventListener("click",(()=>{k.open()}));const g=new i(n,o),L=new i(n,a),y=new i(n,document.querySelector("#update__avatar-form"));g.enableValidation(),L.enableValidation(),y.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlLWljb25cIikgfHxcclxuICAgICAgICBldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cFxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0blRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcbiAgZ2V0Rm9ybSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9mb3JtO1xyXG4gIH1cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnRuVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgc2V0QnV0dG9uVGV4dCh0ZXh0KSB7XHJcbiAgICBpZiAodGhpcy5fc3VibWl0QnV0dG9uKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRCdXR0b25UZXh0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3N1Ym1pdEJ1dHRvbiA/IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA6IFwiXCI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXMgfHwgW107XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lcjtcclxuICAgIHRoaXMuX3VzZXJJZCA9IGRhdGEuY3VycmVudFVzZXJJZDtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQgfHwgZGF0YS5pZDtcclxuXHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICB9XHJcbiAgX3VwZGF0ZUxpa2VzVmlldygpIHtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSlcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgZWxzZVxyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgICAgXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIixcclxuICAgICAgICB0aGlzLmlzTGlrZWQoKVxyXG4gICAgICApO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGF0YS5pc0xpa2VkOyAvLyB0aGlzIHdheVxyXG4gIH1cclxuXHJcbiAgc2V0TGlrZXNJbmZvKGRhdGEpIHtcclxuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZXNWaWV3KCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9pZCwgdGhpcy5pc0xpa2VkKCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2lkLCB0aGlzLl9lbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl91cGRhdGVMaWtlc1ZpZXcoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fdGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2xpa2VDb3VudEVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2VzKGxpa2VzKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgdGhpcy5fdXBkYXRlQ2FyZCgpO1xyXG4gIH1cclxufVxyXG5leHBvcnQgeyBDYXJkIH07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0Vycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaWYgKGVycm9yRWxlbWVudCkge1xyXG4gICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlRXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpZiAoZXJyb3JFbGVtZW50KSB7XHJcbiAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgaXNWYWxpZCA9IHRoaXMuX2lucHV0TGlzdC5ldmVyeShcclxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gICAgaWYgKGlzVmFsaWQpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4gdGhpcy5faGlkZUVycm9yKGlucHV0RWxlbWVudCkpO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcbn1cclxuZXhwb3J0IHsgRm9ybVZhbGlkYXRvciB9O1xyXG4iLCJjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3QgRm9ybVZhbGlkYXRvck9iamVjdHMgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fdHlwZV9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcbmV4cG9ydCB7IGluaXRpYWxDYXJkcywgRm9ybVZhbGlkYXRvck9iamVjdHMgfTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIEZvcm1WYWxpZGF0b3JPYmplY3RzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX21vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlTW9kYWxUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX3Byb2ZpbGUtdGl0bGVcIik7XHJcblxyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5jb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlX19uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZV9fZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5cclxuY29uc3QgYWRkUHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbi8vY2FyZCBtb2RhbFxyXG5jb25zdCBjYXJkc0xpc3RFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkc19fbGlzdFwiKTtcclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcclxuICAucXVlcnlTZWxlY3RvcihcIiNjYXJkc19fdGVtcGxhdGVcIilcclxuICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XHJcblxyXG4vL1F1ZXJ5IERvbSBmb3Jtc1xyXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zLnByb2ZpbGVfX2Zvcm07XHJcbmNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXMuY2FyZF9fZm9ybTtcclxuXHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkX19jYXJkLW1vZGFsXCIpO1xyXG5cclxuY29uc3QgYWRkQ2FyZG1vZGFsVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZF9fY2FyZC10aXRsZVwiKTtcclxuY29uc3QgY2FyZE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZF9fY2FyZC1uYW1lXCIpO1xyXG5jb25zdCBjYXJkTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkX19jYXJkLWxpbmtcIik7XHJcblxyXG4vL2ltYWdlIHByZXZpZXdcclxuY29uc3QgaW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2VfX21vZGFsXCIpO1xyXG5jb25zdCBpbWFnZUxpbmsgPSBpbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2VfX2xpbmtcIik7XHJcbmNvbnN0IGltYWdlVGl0bGUgPSBpbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2VfX3RpdGxlXCIpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiMWM2NWM2ZjEtYWJkZC00NzBhLWFlNGQtMzcwMTUzYWQwNWQ5XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIEluaXRpYWxpemUgdXNlciBpbmZvXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IFwiI3Byb2ZpbGVfX3RpdGxlXCIsXHJcbiAgam9iU2VsZWN0b3I6IFwiI3Byb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkRGF0YSA9IHsgLi4uZGF0YSwgY3VycmVudFVzZXJJZDogdXNlckluZm8uZ2V0VXNlcklkKCkgfTtcclxuXHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBcIiNjYXJkc19fdGVtcGxhdGVcIixcclxuXHJcbiAgICAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgICBpbWFnZVBvcHVwLm9wZW4oeyBuYW1lLCBsaW5rIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxyXG5cclxuICAgIChjYXJkSWQsIGlzTGlrZWQpID0+IHtcclxuICAgICAgY29uc3QgYXBpTWV0aG9kID0gaXNMaWtlZCA/IGFwaS51bmxpa2VDYXJkKGNhcmRJZCkgOiBhcGkubGlrZUNhcmQoY2FyZElkKTtcclxuICAgICAgcmV0dXJuIGFwaU1ldGhvZFxyXG4gICAgICAgIC50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICAgICAgY2FyZC5zZXRMaWtlc0luZm8odXBkYXRlZENhcmQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsaWtpbmcgY2FyZDpcIiwgZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICApO1xyXG5cclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuLy8gQ3JlYXRlIGltYWdlIHBvcHVwIGluc3RhbmNlXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2VfX21vZGFsXCIpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5sZXQgc2VjdGlvbjtcclxuXHJcbi8vIEZldGNoIHVzZXIgaW5mbyBhbmQgaW5pdGlhbCBjYXJkc1xyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIGpvYjogdXNlckRhdGEuYWJvdXQsXHJcbiAgICAgIGF2YXRhcjogdXNlckRhdGEuYXZhdGFyLFxyXG4gICAgICBpZDogdXNlckRhdGEuX2lkLFxyXG4gICAgfSk7XHJcblxyXG4gICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xyXG4gICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBcIiNjYXJkc19fbGlzdFwiXHJcbiAgICApO1xyXG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsb2FkaW5nIGFwcCBkYXRhOlwiLCBlcnIpO1xyXG4gIH0pO1xyXG5cclxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNkZWxldGVfX2NhcmQtbW9kYWxcIiwgKCkgPT4ge1xyXG4gIGFwaVxyXG4gICAgLmRlbGV0ZUNhcmQoY2FyZFRvRGVsZXRlSWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGNhcmRUb0RlbGV0ZUVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBjYXJkOlwiLCBlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldEJ1dHRvblRleHQoXCJZZXNcIik7XHJcbiAgICB9KTtcclxuICBjb25zb2xlLmxvZyhjYXJkVG9EZWxldGVJZCk7XHJcbn0pO1xyXG5cclxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5sZXQgY2FyZFRvRGVsZXRlSWQgPSBudWxsO1xyXG5sZXQgY2FyZFRvRGVsZXRlRWxlbWVudCA9IG51bGw7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRJZCwgY2FyZEVsZW1lbnQpIHtcclxuICBjYXJkVG9EZWxldGVJZCA9IGNhcmRJZDtcclxuICBjYXJkVG9EZWxldGVFbGVtZW50ID0gY2FyZEVsZW1lbnQ7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdChwb3B1cEluc3RhbmNlLCBhcGlNZXRob2QsIHN1Y2Nlc3NDYWxsYmFjaykge1xyXG4gIHBvcHVwSW5zdGFuY2UucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlNZXRob2RcclxuICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpO1xyXG4gICAgICBwb3B1cEluc3RhbmNlLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBJbnN0YW5jZS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoeyBhdmF0YXIgfSkge1xyXG4gIGFwaVxyXG4gICAgLnNldFVzZXJBdmF0YXIoYXZhdGFyKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgICB1cGRhdGVBdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVVcGRhdGUoeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZSh7IG5hbWUsIGFib3V0OiBkZXNjcmlwdGlvbiB9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogcmVzLm5hbWUsXHJcbiAgICAgICAgam9iOiByZXMuYWJvdXQsXHJcbiAgICAgICAgYXZhdGFyOiByZXMuYXZhdGFyLFxyXG4gICAgICAgIGlkOiByZXMuX2lkLFxyXG4gICAgICB9KTtcclxuICAgICAgcHJvZmlsZUZvcm1Qb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBQcm9maWxlIEZvcm0gU3VibWlzc2lvblxyXG5jb25zdCBwcm9maWxlRm9ybVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZV9fbW9kYWxcIiwgKGRhdGEpID0+IHtcclxuICBoYW5kbGVGb3JtU3VibWl0KFxyXG4gICAgcHJvZmlsZUZvcm1Qb3B1cCxcclxuICAgIGFwaS51cGRhdGVQcm9maWxlKHsgbmFtZTogZGF0YS5uYW1lLCBhYm91dDogZGF0YS5kZXNjcmlwdGlvbiB9KSxcclxuICAgICh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgICBqb2I6IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgICAgIGF2YXRhcjogdXNlckRhdGEuYXZhdGFyLFxyXG4gICAgICAgIGlkOiB1c2VyRGF0YS5faWQsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICk7XHJcbn0pO1xyXG5wcm9maWxlRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyBBZGQgQ2FyZCBGb3JtIFN1Ym1pc3Npb25cclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkX19jYXJkLW1vZGFsXCIsIChkYXRhKSA9PiB7XHJcbiAgaGFuZGxlRm9ybVN1Ym1pdChcclxuICAgIGFkZENhcmRQb3B1cCxcclxuICAgIGFwaS5hZGRDYXJkKHsgbmFtZTogZGF0YS50aXRsZSwgbGluazogZGF0YS5pbWFnZSB9KSxcclxuICAgIChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gICAgICBhZGRDYXJkRm9ybS5yZXNldCgpOyAvLyByZXNldFxyXG4gICAgICBhZGRDYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7IC8vIGRpc2FibGVcclxuICAgIH1cclxuICApO1xyXG59KTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gVXBkYXRlIEF2YXRhciBGb3JtIFN1Ym1pc3Npb25cclxuY29uc3QgdXBkYXRlQXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiN1cGRhdGVfX2F2YXRhci1tb2RhbFwiLCAoZGF0YSkgPT4ge1xyXG4gIGhhbmRsZUZvcm1TdWJtaXQoXHJcbiAgICB1cGRhdGVBdmF0YXJQb3B1cCxcclxuICAgIGFwaS51cGRhdGVBdmF0YXIoZGF0YS5hdmF0YXIpLFxyXG4gICAgKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICAgIH1cclxuICApO1xyXG59KTtcclxudXBkYXRlQXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIEV2ZW50IGxpc3RlbmVyc1xyXG5kb2N1bWVudFxyXG4gIC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2VkaXQtYnV0dG9uXCIpXHJcbiAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgICBwcm9maWxlRm9ybVBvcHVwLnNldElucHV0VmFsdWVzKHtcclxuICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmpvYixcclxuICAgIH0pO1xyXG4gICAgcHJvZmlsZUZvcm1Qb3B1cC5vcGVuKCk7XHJcbiAgfSk7XHJcblxyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2FkZC1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmRvY3VtZW50XHJcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fYXZhdGFyLWVkaXQtYnV0dG9uXCIpXHJcbiAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICB1cGRhdGVBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbiAgfSk7XHJcblxyXG4vLyBFbmFibGUgZm9ybSB2YWxpZGF0aW9uXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgRm9ybVZhbGlkYXRvck9iamVjdHMsXHJcbiAgcHJvZmlsZUZvcm1cclxuKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBGb3JtVmFsaWRhdG9yT2JqZWN0cyxcclxuICBhZGRDYXJkRm9ybVxyXG4pO1xyXG5jb25zdCB1cGRhdGVBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgRm9ybVZhbGlkYXRvck9iamVjdHMsXHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN1cGRhdGVfX2F2YXRhci1mb3JtXCIpXHJcbik7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG51cGRhdGVBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIF9yZXF1ZXN0KGVuZHBvaW50LCBvcHRpb25zID0ge30pIHtcclxuICAgIGNvbnN0IGZpbmFsT3B0aW9ucyA9IHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLi4ub3B0aW9ucyxcclxuICAgIH07XHJcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLl9iYXNlVXJsfSR7ZW5kcG9pbnR9YDtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIGZpbmFsT3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIik7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKF9pZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke19pZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoX2lkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7X2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1bmxpa2VDYXJkKF9pZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke19pZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwRGF0YSgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcbiAgZ2V0VXNlcklkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3VzZXJJZDtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iLCBhdmF0YXIsIGlkIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBqb2I7XHJcbiAgICB0aGlzLnNldFVzZXJBdmF0YXIoYXZhdGFyKTtcclxuICAgIHRoaXMuX3VzZXJJZCA9IGlkO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1saW5rXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlLXRpdGxlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlQ29uZmlybSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVDb25maXJtID0gaGFuZGxlQ29uZmlybTtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIiNkZWxldGVfX2NhcmQtY29uZmlybS1idXR0b25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVDb25maXJtKCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIHNldEJ1dHRvblRleHQodGV4dCkge1xyXG4gICAgaWYgKHRoaXMuX2NvbmZpcm1CdXR0b24pIHtcclxuICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IHRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJTZWN0aW9uIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwidGhpcyIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zdWJtaXRCdG5UZXh0IiwidGV4dENvbnRlbnQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsImdldEZvcm0iLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiZGF0YSIsInByZXZlbnREZWZhdWx0Iiwic2V0QnV0dG9uVGV4dCIsInRleHQiLCJnZXRCdXR0b25UZXh0IiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsIl9kYXRhIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJJZCIsImN1cnJlbnRVc2VySWQiLCJfaWQiLCJpZCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl91cGRhdGVMaWtlc1ZpZXciLCJpc0xpa2VkIiwiX2xpa2VCdXR0b24iLCJ0b2dnbGUiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwic2V0TGlrZXNJbmZvIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJfZGVsZXRlQnV0dG9uIiwiX2VsZW1lbnQiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJ1cGRhdGVDYXJkIiwiX3RpdGxlRWxlbWVudCIsIl9saWtlQ291bnRFbGVtZW50IiwidXBkYXRlTGlrZXMiLCJfdXBkYXRlQ2FyZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsIkFycmF5IiwiZnJvbSIsIl9zaG93RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlRXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImV2ZXJ5IiwiZGlzYWJsZWQiLCJkaXNhYmxlQnV0dG9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsInJlc2V0VmFsaWRhdGlvbiIsIkZvcm1WYWxpZGF0b3JPYmplY3RzIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsInByb2ZpbGVfX2Zvcm0iLCJhZGRDYXJkRm9ybSIsImNhcmRfX2Zvcm0iLCJpbWFnZU1vZGFsIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJlbmRwb2ludCIsIm9wdGlvbnMiLCJmaW5hbE9wdGlvbnMiLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJnZXRVc2VySW5mbyIsInVwZGF0ZVByb2ZpbGUiLCJfcmVmMiIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJhZGRDYXJkIiwiX3JlZjMiLCJkZWxldGVDYXJkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiZ2V0QXBwRGF0YSIsImFsbCIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50Iiwiam9iIiwiZ2V0VXNlcklkIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwiY2FyZCIsImltYWdlUG9wdXAiLCJoYW5kbGVEZWxldGVDYXJkIiwiY2FyZElkIiwidXBkYXRlZENhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIl9pbWFnZSIsIl9jYXB0aW9uIiwic2VjdGlvbiIsInVzZXJEYXRhIiwiY2FyZHMiLCJjYXJkRWxlbWVudCIsImRlbGV0ZUNhcmRQb3B1cCIsImhhbmRsZUNvbmZpcm0iLCJfaGFuZGxlQ29uZmlybSIsIl9jb25maXJtQnV0dG9uIiwiZSIsImNhcmRUb0RlbGV0ZUlkIiwiY2FyZFRvRGVsZXRlRWxlbWVudCIsImZpbmFsbHkiLCJsb2ciLCJwb3B1cEluc3RhbmNlIiwiYXBpTWV0aG9kIiwic3VjY2Vzc0NhbGxiYWNrIiwicmVzcG9uc2UiLCJwcm9maWxlRm9ybVBvcHVwIiwiZGVzY3JpcHRpb24iLCJhZGRDYXJkUG9wdXAiLCJ0aXRsZSIsImltYWdlIiwicmVzZXQiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsInVwZGF0ZUF2YXRhclBvcHVwIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJ1cGRhdGVBdmF0YXJGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==